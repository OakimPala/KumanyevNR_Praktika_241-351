# Исследование технологии Web Application Firewall (WAF)

## Что такое WAF?
**Web Application Firewall (WAF)** — это специализированный межсетевой экран, защищающий веб-приложения на **7-м уровне модели OSI** (уровень приложений). В отличие от сетевых экранов, WAF анализирует **HTTP/HTTPS-трафик**, выявляя и блокируя атаки, такие как:
- SQL-инъекции,
- XSS (межсайтовый скриптинг),
- CSRF (подделка межсайтовых запросов),
- DDoS на уровне приложений.

---

## Принципы работы WAF
WAF действует как промежуточный фильтр между пользователем и сервером:
1. **Инспекция трафика**: анализ входящих и исходящих HTTP-запросов.
2. **Сравнение с шаблонами**: проверка на соответствие сигнатурам известных атак (например, через базы OWASP Top 10).
3. **Анализ аномалий**: выявление подозрительного поведения с помощью машинного обучения.
4. **Действия**: 
   - Блокировка запроса,
   - Перенаправление на CAPTCHA,
   - Логирование события для дальнейшего анализа.

---

## Типы WAF
### 1. Аппаратные (сетевые)
- **Примеры**: F5 BIG-IP.
- **Плюсы**: Высокая производительность.
- **Минусы**: Дорогое развертывание.

### 2. Программные
- **Примеры**: ModSecurity (для Apache/Nginx).
- **Плюсы**: Гибкость, низкая стоимость.
- **Минусы**: Нагрузка на сервер.

### 3. Облачные
- **Примеры**: Cloudflare, AWS WAF.
- **Плюсы**: Простота настройки, автоматические обновления.
- **Минусы**: Зависимость от провайдера.

---

## Защищаемые угрозы и методы обнаружения
### Угрозы
- SQL/NoSQL-инъекции,
- XSS и CSRF,
- Атаки типа **Slowloris**,
- Логические уязвимости (BOLA, IDOR).

### Методы обнаружения
- **Сигнатурный анализ**: Сравнение с шаблонами атак.
- **Поведенческий анализ**: ML для выявления аномалий.
- **White/Black листы**: Разрешение/блокировка по IP или URL.

---

## Популярные WAF-решения
1. **ModSecurity**: Открытое решение с поддержкой кастомных правил.
2. **Cloudflare WAF**: Облачный сервис с защитой от ботов и DDoS.
3. **AWS WAF**: Интеграция с AWS (например, для защиты API Gateway).
4. **Imperva**: Продвинутая защита API и веб-приложений.
5. **F5 BIG-IP**: Высокопроизводительное аппаратное решение.

---

## Ограничения WAF
- **Не заменяет безопасную разработку** (требуются Code Review, SAST/DAST).
- **Ложные срабатывания** (false positives) и пропущенные атаки (false negatives).
- Сложность тонкой настройки под специфику приложения.

---

## Выводы
1. WAF — критически важный, но **не единственный** элемент защиты. 
2. Рекомендуется комбинировать с:
   - Secure SDLC (безопасная разработка),
   - Защитой от DDoS,
   - Системами мониторинга (SIEM).
3. **Для небольших проектов**: Cloudflare WAF или ModSecurity.
4. **Для корпораций**: F5 BIG-IP, Imperva.
